{"remainingRequest":"/Users/annakleinloog/Documents/IT/GitHub/CoachesVueApp/node_modules/babel-loader/lib/index.js!/Users/annakleinloog/Documents/IT/GitHub/CoachesVueApp/node_modules/eslint-loader/index.js??ref--14-0!/Users/annakleinloog/Documents/IT/GitHub/CoachesVueApp/src/store/modules/auth/actions.js","dependencies":[{"path":"/Users/annakleinloog/Documents/IT/GitHub/CoachesVueApp/src/store/modules/auth/actions.js","mtime":1732785888814},{"path":"/Users/annakleinloog/Documents/IT/GitHub/CoachesVueApp/babel.config.js","mtime":1598433744000},{"path":"/Users/annakleinloog/Documents/IT/GitHub/CoachesVueApp/node_modules/cache-loader/dist/cjs.js","mtime":1731913129120},{"path":"/Users/annakleinloog/Documents/IT/GitHub/CoachesVueApp/node_modules/babel-loader/lib/index.js","mtime":1731913127826},{"path":"/Users/annakleinloog/Documents/IT/GitHub/CoachesVueApp/node_modules/eslint-loader/index.js","mtime":1731913018534}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwpsZXQgdGltZXI7CmV4cG9ydCBkZWZhdWx0IHsKICBhc3luYyBsb2dpbihjb250ZXh0LCBwYXlsb2FkKSB7CiAgICByZXR1cm4gY29udGV4dC5kaXNwYXRjaCgnYXV0aCcsIHsKICAgICAgLi4ucGF5bG9hZCwKICAgICAgbW9kZTogJ2xvZ2luJwogICAgfSk7CiAgfSwKICBhc3luYyBzaWdudXAoY29udGV4dCwgcGF5bG9hZCkgewogICAgcmV0dXJuIGNvbnRleHQuZGlzcGF0Y2goJ2F1dGgnLCB7CiAgICAgIC4uLnBheWxvYWQsCiAgICAgIG1vZGU6ICdzaWdudXAnCiAgICB9KTsKICB9LAogIGFzeW5jIGF1dGgoY29udGV4dCwgcGF5bG9hZCkgewogICAgY29uc3QgbW9kZSA9IHBheWxvYWQubW9kZTsKICAgIGxldCB1cmwgPSBgaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vdjEvYWNjb3VudHM6c2lnbkluV2l0aFBhc3N3b3JkP2tleT1BSXphU3lBY1hnYkR6Tnc3Q29lM096NzdVUDMteFBNRmgwWnVsandgOwogICAgaWYgKG1vZGUgPT09ICdzaWdudXAnKSB7CiAgICAgIHVybCA9ICdodHRwczovL2lkZW50aXR5dG9vbGtpdC5nb29nbGVhcGlzLmNvbS92MS9hY2NvdW50czpzaWduVXA/a2V5PUFJemFTeUFjWGdiRHpOdzdDb2UzT3o3N1VQMy14UE1GaDBadWxqdyc7CiAgICB9CiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgewogICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgIGVtYWlsOiBwYXlsb2FkLmVtYWlsLAogICAgICAgIHBhc3N3b3JkOiBwYXlsb2FkLnBhc3N3b3JkLAogICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlCiAgICAgIH0pCiAgICB9KTsKICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKICAgIGlmICghcmVzcG9uc2Uub2spIHsKICAgICAgY29uc29sZS5sb2cocmVzcG9uc2VEYXRhKTsKICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IocmVzcG9uc2VEYXRhLm1lc3NhZ2UgfHwgJ0ZhaWxlZCB0byBhdXRoZW50aWNhdGUsIGNoZWNrIHlvdXIgbG9naW4gZGF0YS4nKTsKICAgICAgdGhyb3cgZXJyb3I7CiAgICB9CiAgICBjb25zdCBleHBpcmVzSW4gPSArcmVzcG9uc2VEYXRhLmV4cGlyZXNJbiAqIDEwMDA7CiAgICBjb25zdCBleHBpcmF0aW9uRGF0ZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgZXhwaXJlc0luOwogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Rva2VuJywgcmVzcG9uc2VEYXRhLmlkVG9rZW4pOwogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJJZCcsIHJlc3BvbnNlRGF0YS5sb2NhbElkKTsKICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0b2tlbkV4cGlyYXRpb24nLCBleHBpcmF0aW9uRGF0ZSk7CiAgICB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICBjb250ZXh0LmRpc3BhdGNoKCdhdXRvTG9nb3V0Jyk7CiAgICB9LCBleHBpcmVzSW4pOwogICAgY29udGV4dC5jb21taXQoJ3NldFVzZXInLCB7CiAgICAgIHRva2VuOiByZXNwb25zZURhdGEuaWRUb2tlbiwKICAgICAgdXNlcklkOiByZXNwb25zZURhdGEubG9jYWxJZAogICAgfSk7CiAgfSwKICB0cnlMb2dpbihjb250ZXh0KSB7CiAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpOwogICAgY29uc3QgdXNlcklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJJZCcpOwogICAgY29uc3QgdG9rZW5FeHBpcmF0aW9uID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuRXhwaXJhdGlvbicpOwogICAgY29uc3QgZXhwaXJlc0luID0gK3Rva2VuRXhwaXJhdGlvbiAtIG5ldyBEYXRlKCkuZ2V0VGltZSgpOwogICAgaWYgKGV4cGlyZXNJbiA8IDApIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgY29udGV4dC5kaXNwYXRjaCgnYXV0b0xvZ291dCk7Jyk7CiAgICB9LCBleHBpcmVzSW4pOwogICAgaWYgKHRva2VuICYmIHVzZXJJZCkgewogICAgICBjb250ZXh0LmNvbW1pdCgnc2V0VXNlcicsIHsKICAgICAgICB0b2tlbjogdG9rZW4sCiAgICAgICAgdXNlcklkOiB1c2VySWQKICAgICAgfSk7CiAgICB9CiAgfSwKICBsb2dvdXQoY29udGV4dCkgewogICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3Rva2VuJyk7CiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndXNlcklkJyk7CiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndG9rZW5FeHBpcmF0aW9uJyk7CiAgICBjbGVhclRpbWVvdXQodGltZXIpOwogICAgY29udGV4dC5jb21taXQoJ3NldFVzZXInLCB7CiAgICAgIHRva2VuOiBudWxsLAogICAgICB1c2VySWQ6IG51bGwKICAgIH0pOwogIH0sCiAgYXV0b0xvZ291dChjb250ZXh0KSB7CiAgICBjb250ZXh0LmRpc3BhdGNoKCdsb2dvdXQnKTsKICAgIGNvbnRleHQuY29tbWl0KCdzZXRBdXRvTG9nb3V0Jyk7CiAgfQp9Ow=="},{"version":3,"names":["timer","login","context","payload","dispatch","mode","signup","auth","url","response","fetch","method","body","JSON","stringify","email","password","returnSecureToken","responseData","json","ok","console","log","error","Error","message","expiresIn","expirationDate","Date","getTime","localStorage","setItem","idToken","localId","setTimeout","commit","token","userId","tryLogin","getItem","tokenExpiration","logout","removeItem","clearTimeout","autoLogout"],"sources":["/Users/annakleinloog/Documents/IT/GitHub/CoachesVueApp/src/store/modules/auth/actions.js"],"sourcesContent":["let timer;\n\nexport default{\n    async login(context, payload) {\n       return context.dispatch('auth', {\n            ...payload, \n            mode: 'login'\n        })\n\n    },\n    async signup(context, payload) {\n        return context.dispatch('auth', {\n            ...payload, \n            mode: 'signup'\n        })\n    },\n    async auth(context, payload){\n        const mode = payload.mode;\n        let url = `https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyAcXgbDzNw7Coe3Oz77UP3-xPMFh0Zuljw`\n        \n        if(mode === 'signup'){\n            url = 'https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyAcXgbDzNw7Coe3Oz77UP3-xPMFh0Zuljw'\n        }\n        \n        const response = await fetch(\n            url,\n            {\n                method: 'POST',\n                body: JSON.stringify({\n                    email: payload.email,\n                    password: payload.password,\n                    returnSecureToken: true\n                })\n            }\n        );\n\n        const responseData = await response.json();\n\n        if(!response.ok){\n            console.log(responseData);\n            const error = new Error(responseData.message || \n                'Failed to authenticate, check your login data.'\n            );\n            throw error;\n        }\n\n        const expiresIn = +responseData.expiresIn * 1000;\n\n       \n        const expirationDate = new Date().getTime() + expiresIn;\n\n        localStorage.setItem('token', responseData.idToken);\n        localStorage.setItem('userId', responseData.localId);\n        localStorage.setItem('tokenExpiration', expirationDate);\n\n        timer = setTimeout(function(){\n            context.dispatch('autoLogout');\n        } , expiresIn)\n        context.commit('setUser', {\n            token: responseData.idToken,\n            userId: responseData.localId,\n\n        });\n    },\n    tryLogin(context){\n        const token = localStorage.getItem('token');\n        const userId = localStorage.getItem('userId');\n        const tokenExpiration = localStorage.getItem('tokenExpiration');\n\n        const expiresIn = +tokenExpiration - new Date().getTime();\n\n        if(expiresIn < 0){\n            return;\n        }\n\n       timer = setTimeout(function(){\n            context.dispatch('autoLogout);')\n        },expiresIn)\n\n        if(token&&userId){\n            context.commit('setUser', {\n                token: token,\n                userId: userId,\n            });\n        }\n    },\n    logout(context){\n\n        localStorage.removeItem('token');\n        localStorage.removeItem('userId');\n        localStorage.removeItem('tokenExpiration');\n\n        clearTimeout(timer);\n\n   context.commit('setUser',{\n    token: null,\n    userId: null,\n   })\n    },\n    autoLogout(context){\n        context.dispatch('logout');\n        context.commit('setAutoLogout');\n    }\n        \n\n}"],"mappings":"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","ignoreList":[]}]}